---
type: Notes
noteType: experience
source:
title: 结构方程模型
aliases:
  - SEM
  - sem
memo:
createDate: 2025-11-20 11:46
modifyDate: 2025-11-20 11:56
tags:
  - SEM
  - 潜变量
cssclasses:
---

### 1. 基本内容

统计学想要达成的最终目标就是得到某两个结果之间的因果关系，即**因果推断 (Causal Inference)**。按照统计方法的不同作用，又可以分为三代统计方法 [^1]，其中 $t$ 检验、方差分析等就是第一代统计方法，它们致力于测量“**观察变量**” (可以准确测量的、操作的变量，例如身高、体重)，但是无法得知“因果关系 (理论面，无法真正证明因果)”以及“**潜变量** (无法被准确测量的变量，例如情绪控制能力) 的影响”，因此**结构方程模型 (Structural Equation Modeling, SEM)** 出现了 [^2]。SEM 致力于分析“潜变量”，通过加入潜变量，可以降低测量偏差对模型的影响 [^3]。

- 在实际研究中，通常通过多个观察变量来反映某个潜变量 (例如，量表中的某三题的分数代表了一个维度)。

> [!note]- “使用 SPSS 因子分析后得到的因子项做回归”和 SEM 有什么差异呢？[^2]
> 虽然都用到了问卷测出的数据，但是在数据处理上存在差异，
> - 第一代统计方法：将多个测量项目打包，得平均值，即将潜变量替换为观察变量；
> - SEM：纳入所有变量，减少数据损失 (因为没取均值)，减少测量偏差。

> [!note]- 结构方程模型 vs. 传统分析方法 [^4]
> 1. SEM 更加灵活，更加综合。传统方法的模型是提前规定的或者说是默认的，而做结构方程的时候，它对变量关系的限制几乎没有，需要你自己根据理论知识设定变量之间的关系。
> 		- 在回归中，默认“自变量直接影响因变量”，无法同时分析多个变量之间的关系，或同时处理更为复杂的关系；
> 2. SEM 既包含显变量又有潜变量，而传统的方法只分析显变量；
> 3. 在 SEM 中我们认为误差是存在的，你甚至可以规定不同变量之间误差的关系，但是传统的方法认为误差是没有的；
> 		- 回归默认 “误差随机且独立”，忽略误差间的关联；而 SEM 中可以拉残差相关。
> 4. 结构方程模型可以很好地容忍**多重共线性**[^5]，SEM 允许误差项之间的关系 (可以拉残差相关或者测量变量之间的相关)，这使得 SEM 在处理多重共线性问题时更具灵活性。

#### 1.2. 基本名词

按照是否可以被直接测量，结构方程模型包含两种变量。

- **观察变量/标识/测量变量** (Observed/measured/indicator/manifest Variable)：可以直接观察或测量的变量，如血压、销货量、价格、所得等 (量表的每一道题就是一个观测变量)。
- **潜变量/因子/构面** (Latent Variables)：无法直接进行观测，因此藉由数个观察变量反应的结果间接测量，如态度、组织承诺等。

观察变量受到潜变量和**误差变异项** (残差/测量误差) 的共同影响。

<img src="https://i.postimg.cc/63phT00C/结构方程模型.png" width="600"/>

按照影响关系，结构方程又主要包含以下几种变量，

- **外生变量/自变量** (Independent/predictor/**exogenous**(external) variables)：模型中影响其他变量的变量，本身不具测量误差 (unique/error variables)，**在模型图中没有被任何单向箭头刺到**。
- **内生变量/因变量** (Dependent/criterion/**endogenous**(internal)/variable/effects of other variables)：被任何自变量影响 (估计) 的变量，本身具有测量误差，该变量也有可能估计别的内生变量，**在模型图中凡是模型中被单向箭头刺到的变量均为内生变量**。
- 测量误差 (Error/residual)：观察变量被潜变量估计后无法被解释的方差 (指向方框的残差)；
- 结构误差/预测误差 (Disturbance)：潜变量经其它变量估计后无法解释的方差，也被称为残差 (Residual) 或者独特因素 (unique factor)/不可解释方差 (指向内生变量的残差)。

上述两种分类的组合就囊括了一个完全结构方程模型可能出现的所有变量类型：外生潜变量、内生潜变量、外生标识、内生标识、测量误差项和预测误差项，其中外生标识和内生标识是指测量外生/内生潜变量的观测变量。

---

参数是结构方程模型的重要部分，指的是结构模型中需要估计的独立参数的数量，这些参数包括所有变量的变异数、变量间的共变异数以及回归路径的系数 [^6]。分为自由参数和固定参数。

- **固定参数** (fix parameter)：研究者在估计前给定一个特定值，模型中不予估计的参数，一般均设定为 0 或 1，当然也可以依研究目的来决定任何一个数字。
- **自由参数** (free parameter)：模型中所估计的每一个值。模型每多估计 1 个参数，自由度 (degree of freedom, df) 就会少 1 个，因此同一个模型自由度愈少，表示估计的参数愈多，模型愈复杂。

通过固定参数的方法能够保证方程有唯一解，但是要满足一个条件，即自由参数的个数必须要小于或等于样本协方差矩阵中非冗余元素的个数 (具体见后文)。为什么要小于等于呢？简单来说，要解一个带有两个 x,y 的一个方程，至少还需要表示 x,y 之间关系的另一个方程，才能得到唯一解，当然，再多一个方程也可以解出来。

结构方程模型包括测量模型和结构模型，

- **测量模型** (Measurement model)：观察变量是否能够反映所代表的潜变量、观察变量是否稳定等；
	- 主要包括 [[因子分析#3. 验证性因子分析|验证性因子分析]]，写成方程为 $x=WX \times FX+ex$. 其中，$x$ 为标识/测量变量，$WX$ 为该条相关上的因子载荷，$FX$ 为相应潜变量，$ex$ 为测量误差。
- **结构模型** (Structural model)：潜变量之间构成的模型是否成立、模型是否与数据高拟合等。
	- 主要包括回归分析和路径分析 (Path analysis)[^7]，写成方程为 $FY = WQ \times FY + WP \times FX +r$. 其中，$FY$ 为内生变量，$WQ$ 和 $WP$ 为外生变量，$FY$ 和 $FX$ 分别为对应路径的回归系数矩阵，$r$ 为残差。

> [!note]- SEM 的本质
> 统计上来看，SEM 的本质是分析两个变量的**协方差**[^8]，而协方差就是两个变量协同情况下的偏离情况，两个变量的变化规律越协同一致，则其协方差的数值越大。我们计算
>
> 1. 对于一系列变量，我们可以得到一个“方差 - 协方差矩阵”，在矩阵中对角线为变量的方差，其余部分为变量的协方差，这个矩阵称为 `oberseved 方差 - 协方差矩阵`。
> 2. 之后通过最大拟然法建立的 SEM 模型对这个矩阵进行估计，得到一个 “model-estimated 方差 - 协方差矩阵”，最后将两个矩阵结合得到最终的 ”global oberseved 方差 - 协方差矩阵“。
> 3. 在此过程中我们要评估 model-estimated 的矩阵与 observed 矩阵的匹配情况，就是 Goodness-of-fit。

#### 1.3. 基本步骤

SEM 模型设定分析的基本步骤一般可以分为 [^9] [^10]。

1. 模型设定——根据理论或经验；
2. 模型识别——判断能否得到唯一解；
3. 模型估计——确定各种估计方法；
4. 模型评价——对拟合度作出评价；
5. 模型修正——模型再设定。

首先，我们需要根据理论或经验，预期变量之间的关系；

1. 概念化模型：明确潜变量之间的假设关系、明确观察变量与构面 (construct，某一潜变量) 的关系。一般来说，每个构面对应 3-4 个题目，不超过 5-6 个构面。
2. 建构路径图：简单画一个预期的路径图 (path diagram)。
3. 软件设定：在软件中设定变量间的预期关系。

其次，我们需要确定方程是否能得出唯一解。而这，取决于“**数据给出的信息**”能否求出所有“**模型设定的需要估计的参数**”，即自由参数 ($T$)。“数据给出的信息”主要是观察变量的协方差/相关系数数量，即 $\frac{(p)(p+1)}{2}$，$p$ 指的是模型中标识的个数。而模型的自由度 $df$ 则可以指富余的“数据给出的信息”。

- 当 $df = 0\ ,即\frac{(p)(p+1)}{2} = T$ 时，表示数据刚好能解答预先设定的模型，即刚好识别模型；
- 当 $df > 0\ ,即\frac{(p)(p+1)}{2} > T$ 时，表示数据解答完预先设定的模型还有富余信息，即过度识别模型；
- 当 $df < 0\ ,即\frac{(p)(p+1)}{2} < T$ 时，表示数据给的信息不够解答完预先设定的模型，即低度识别模型。

那么如何估计 $T$ 呢？自由参数 $T$ 是除去固定参数后，模型中还需要使用数据估计的参数。因此我们首先需要直到模型的所有参数，主要包括变量的变异数、变量间的共变异数以及回归路径的系数 [^10]。

1. 因子载荷 $\lambda$：测量模型中潜变量指向指标的箭头数量；
2. 误差方差 $\delta \ \varepsilon \ \zeta$：包括测量误差 (指标未被潜变量解释的部分) 和结构误差 (内生潜变量未被外生潜变量解释的部分)，即误差/残差的数量。
3. 潜变量方差 $\varphi \ \psi$：外生潜变量的方差 (内生潜变量的方差可以由外生潜变量的方差和结构误差推导，所以不算)。
4. 潜变量协方差 $\varphi$：外生潜变量之间的 “相关程度”，即外生潜变量之间的双向箭头数量，如果外生潜变量数量大于等于 2，就必须要拉相关，即外生潜变量之间不可能没有相关，拉相关就是将多重共线性考虑进去了。
5. 结构路径系数 $\gamma \ \beta$：潜变量之间的单向箭头数量。

固定参数就是设置“1”的因子载荷数量。为了比较潜变量对不同指标的解释程度，我们需要进行标准化，因此通常将第一个指标的因子载荷设置为 1。同样的，我们也倾向于将残差解释指标的因子载荷设置为 1，以比较残差与潜变量对指标的解释程度。

<img src="https://i.postimg.cc/j550GL1D/结构方程模型.png" width="600"/>
如果你掌握了自由参数和固定参数的算法，那么可以尝试一下能否算出上图中模型的各个参数个数 (36个估计参数，其中21个自由参数, 15个固定参数)。

> [!attention]- 设定模型时，为什么默认残差独立？
> 残差分析是评估模型拟合度和检验模型假设的重要方法，是线性回归分析中的一个重要假设，要求模型的残差之间没有相关性，以确保模型的有效性和可靠性。然而在 SEM 中，通过拉关系可以将这种可能存在的影响提前考虑，可是为什么不做呢？
> 1. 若默认残差不独立，自由参数会指数级增加，极易导致 “模型自由度为负” (模型不可识别)；
> 2. 如果给标识的残差之间拉相关，在理论上不好解释。

模型参数估计的目的是让样本协方差矩阵与模型隐含的协方差矩阵差异最小。残差小，拟合度高，不拒绝模型，反之亦然。主要采用最大似然法 (ML) 和广义最小二乘法 (GLS) 进行，但是要求数据为连续变量且服从多元正态分布。

当软件跑完模型后，就需要对模型和数据之间的拟合程度 (model fit) 进行评价，此时需要借助一些指标来帮助我们判断模型的拟合劣度/优度。

1. $\chi^2$ 值，即 $\frac{\chi^2}{df}<2$ 时，模型拟合较好 ($\chi^2$ 越小越好)；
2. $GFI/CFI > 0.9$ 时，模型拟合较好；
3. $TLI> 0.9$ 时，模型拟合较好；
4. $RMSEA<0.05/0.08$ 且其 $90\%CI$ 的上限 $\le0.08$，$p > 0.05$ 时，模型拟合较好 (发表时通常为 $0.08$)；
5. 简约拟合指数，包括 $PGFI、PNFI、PCFI$，这些值大于 $0.5$，表示拟合良好。

如果模型拟合度不理想，需进行修正 (必须有理论基础)。重新设定模型、可以藉由**修正指数 (modification indices)** 进行修正，最好不要拉残差相关。主要包括测量模型的修改、增加新的结构参数或者设定某些误差项。

- 修正指数：将模型中每一个固定参数作为自由参数估计时，模型检验的卡方值能够降低多少，MI 越高表示通过该改变能够提高更多的模型拟合度。
- Wald test：用于评估模型中某些参数是否可以被约束为零 (或其他固定值) 而不显著影响模型拟合 (对每个参数进行单独测试)。

### 2. 使用 Amos 进行 SEM

作为统计可视化类软件，Amos 的操作较为简单和直观。操作过程中的最大问题可能不是如何看数据或如何设置，而是调整结构方程图的排版。事实上，Amos 的排版功能做的像 80 岁老太太拄拐杖一样。然而，首先于叙述条件，在本笔记中就不再阐述如何使用 Amos 画出排版整齐的结构方程图。

#### 2.1 构建模型

使用 Amos 画图的主要步骤如下 (下面，我会使用类似 [1,2] 的形式来描述我使用的工具，e.g., [1,2] 指的是从左到右、从上到下数第 1 行第 2 个工具)，

1. 新建一个 amw 文件：由于每次打开 Amos 都会弹出你上一个制作的文件，因此需要依次点击 `File - New` 创建一个新的文件来储存你的工作 (记得 `ctrl + s` 保存到某个文件夹路径中)。
2. 绘制一个简单的测量模型单元：使用 [1,3] 工具在空白处多次点击即可获得一个最基本的 SEM 结构——“残差→指标→潜变量”，如果再多点几下，就会出现多个“残差→指标”指向一个潜变量。
3. 选中、移动和调整大小等：
	1. 选中和移动，一般来说我们很少用 [4,1~3] 工具 (“手”)，因为我实在想不出为什么要用它。虽然它是个小手，但它只能选中元素，而不能移动。移动工具为 [5,2] (“小车”)，要注意的如果你想要对称且同时改变连接该潜变量的所有指标，你需要点选 [10,3] 工具 (Preserve symmetries)。处于选中状态后，再用小车移动某一个指标时，你会发现其他指标也跟着移动了，而且还是对称移动的。如果你想要移动整个测量模型单元，你只需要使用小车工具拖动潜变量即可。
	2. 调整大小：同样的，[10,3] 工具要处于选中状态，这样你才能保证在改变某一个指标时其他指标能同步改变。使用 [6,1] 工具 (" 箭头蓝框 ")，长按某个元素向四边拖动即可改变大小。
	3. 整体旋转：使用 [6,2] 工具点击潜变量即可旋转整个单元，但是从垂直到水平或从水平到垂直时，会有一定拉伸变化，需要自行调整。
	4. 整体复制：保证 [10,3] 工具处于选中状态，使用 [5,1] (“收音机”) 长按你想要复制的某个测量模型单元的潜变量，并拖动到其他位置，松开后即可获得新的测量模型单元。
	- 其他操作：使用 [5,3] 工具 (“×”) 点击你想删掉的元素即可删除元素；按住 `ctrl` 并滚动鼠标滚轮可以实现画布的放大或缩小，在 `View - Interface Properties - Page Layout` 中可以设置画布的大小。
4. 设置路径模型：主要就是使用 [2,1] 工具和 [2,2] 工具给潜变量之间拉线，拉完后觉得不好看可以使用 [7,3] 工具 (“魔术手”) 点击线两端的潜变量，让线条自动调整连接位置，让线条与潜变量间连接地更优雅。
	- 可以使用 [2,3] 工具新增结构残差，点击对应的内生潜变量即可生成残差。

根据理论制定好结构方程图后，就可以开始导入数据、填写对应变量名了。

1. 导入数据：点击 [8,1] 工具后，在弹出的提示框中点击“File Name”导入 sav 文件；
	- 如果需要分组的话，在导入数据文件后，点击“Grouping Variable”选择分组变量，然后点击“Group Value”选择对应的组的编号/值，这一组就会设定在“Group number 1”中 (在小工具栏的右边第二栏，如果你点击的话可以新建更多的组，但是每个组都需要重新导入数据、设置“Grouping Variable”和对应的不同的“Group Value”)[^11]。
2. 给每个元素赋值：在无工具的情况下，点击某个元素。在弹出的对话框中，填写“Variable name”值，其内容必须与 sav 文件中的变量名一致。

完成这些模型构建的工作后，我们就可以进行分析并且查看数据了。

1. 设置 Output 内容：依次点击 `View - Analysis Properties - Output`，勾选 Standardized estimates, Modification indices, Covariances of estimates, Correlations of estimates。
2. 开始分析并查看输出结果：点击 [8,3] 工具 (Calculate estimates) 即开始分析，分析完后会出现两个变化。首先，工具栏右边的最上方出现了一个新的可点击的东西，点击即可将结构方程设定图切换为带有结果的结构方程图。通过点击该栏的第四块的“Standardized estimates”可切换为带有标准化结果的结构方程图 [^12]。其次，现在 [9,2] 工具可以点击了，点击该工具即可查看输出的结果，当然该输出也被保存在 AmosOutput 文件中。

#### 2.2 查看结果

我们主要看“Notes for Model”、“Estimates”、“Model Fit”、“Modification Indices”这四张表的结果，

- Notes for Model：标注了模型的 $\chi^2$, $df$，以及自由参数数量。
- Estimates：“Regression Weights”里标注了因子载荷和路径系数，“Standardized Regression Weights”里标注了标准化的因子载荷和路径系数。
- Model Fit：主要呈现了衡量模型拟合优度的指标。
- Modification Indices：主要呈现了模型修正指数，通过应用 MI 较大的建议可以提高模型拟合度。

### 3. 使用 R 进行 SEM

在 R 中进行 SEM 主要会用到 lavaan 函数包 [^13]，使用 lavaan 函数包通常需要我们设定模型、拟合模型，这个过程遇到的相关语法，

1. 设定模型：
	- 定义测量模型："F1=x1 + x2 + x3" (F1 为潜变量，x1-x3 为观察变量)；
	- 回归 (结构模型，即结构模型图中的大箭头)："f1 ~ f2 + f3" (有两个箭头，分别为从 f2 指向 f1、从 f3 指向 f1)；
	- 方差和协方差："y1 ~~ y5" (指的是 y1 与 y5 的协方差)；"y1 ~~ y1" (指的是 y1 的方差)。
2. 拟合模型："fit <- sem(model, data = 数据集名称)"
3. 输出信息："summary(fit, standardized = TRUE)" (同时输出标准化后的估计参数值)
4. 检验模型拟合度："fitMeasures(fit,c("chisq","df","pvalue',"srmr","rmsea"))"

#### 2.1. 定义模型

在了解了 lavaan 函数包的基本语法后，我们就可以根据官方的案例简单学习 [^14]，

```R
library(lavaan)
library(semPlot)
data(package="lavaan") # 查看某个包内置的数据集
help(PoliticalDemocracy)

data2 <- PoliticalDemocracy # 导入内置数据库为data2

# 定义模型
myModel <- '
 # latent variables 
   ind60 =~ x1 + x2 + x3 
   dem60 =~ y1 + y2 + y3 + y4 
   dem65 =~ y5 + y6 + y7 + y8 
 # regressions
   dem60 ~ ind60 
   dem65 ~ ind60 + dem60 
 # residual covariances 
   y1 ~~ y5
   y2 ~~ y4 + y6 
   y3 ~~ y7 
   y4 ~~ y8
   y6 ~~ y8
'

#模型拟合
fit <- sem(model = myModel, data = data2) 

# 输出基本数据
summary(fit, standardized = TRUE)
```

之后我们就得到输出的数据了，每一项系数均呈现出来了，也不用你瞎找了~

> [!note]- 输出
>
> ```R
> lavaan 0.6-19 ended normally after 68 iterations
> 
>   Estimator                                         ML
>   Optimization method                           NLMINB
>   Number of model parameters                        31
> 
>   Number of observations                            75
> 
> Model Test User Model:
>                                                       
>   Test statistic                                38.125
>   Degrees of freedom                                35
>   P-value (Chi-square)                           0.329
> 
> Parameter Estimates:
> 
>   Standard errors                             Standard
>   Information                                 Expected
>   Information saturated (h1) model          Structured
> 
> Latent Variables:
>                    Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
>   ind60 =~                                                              
>     x1                1.000                               0.670    0.920
>     x2                2.180    0.139   15.742    0.000    1.460    0.973
>     x3                1.819    0.152   11.967    0.000    1.218    0.872
>   dem60 =~                                                              
>     y1                1.000                               2.223    0.850
>     y2                1.257    0.182    6.889    0.000    2.794    0.717
>     y3                1.058    0.151    6.987    0.000    2.351    0.722
>     y4                1.265    0.145    8.722    0.000    2.812    0.846
>   dem65 =~                                                              
>     y5                1.000                               2.103    0.808
>     y6                1.186    0.169    7.024    0.000    2.493    0.746
>     y7                1.280    0.160    8.002    0.000    2.691    0.824
>     y8                1.266    0.158    8.007    0.000    2.662    0.828
> 
> Regressions:
>                    Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
>   dem60 ~                                                               
>     ind60             1.483    0.399    3.715    0.000    0.447    0.447
>   dem65 ~                                                               
>     ind60             0.572    0.221    2.586    0.010    0.182    0.182
>     dem60             0.837    0.098    8.514    0.000    0.885    0.885
> 
> Covariances:
>                    Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
>  .y1 ~~                                                                 
>    .y5                0.624    0.358    1.741    0.082    0.624    0.296
>  .y2 ~~                                                                 
>    .y4                1.313    0.702    1.871    0.061    1.313    0.273
>    .y6                2.153    0.734    2.934    0.003    2.153    0.356
>  .y3 ~~                                                                 
>    .y7                0.795    0.608    1.308    0.191    0.795    0.191
>  .y4 ~~                                                                 
>    .y8                0.348    0.442    0.787    0.431    0.348    0.109
>  .y6 ~~                                                                 
>    .y8                1.356    0.568    2.386    0.017    1.356    0.338
> 
> Variances:
>                    Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all
>    .x1                0.082    0.019    4.184    0.000    0.082    0.154
>    .x2                0.120    0.070    1.718    0.086    0.120    0.053
>    .x3                0.467    0.090    5.177    0.000    0.467    0.239
>    .y1                1.891    0.444    4.256    0.000    1.891    0.277
>    .y2                7.373    1.374    5.366    0.000    7.373    0.486
>    .y3                5.067    0.952    5.324    0.000    5.067    0.478
>    .y4                3.148    0.739    4.261    0.000    3.148    0.285
>    .y5                2.351    0.480    4.895    0.000    2.351    0.347
>    .y6                4.954    0.914    5.419    0.000    4.954    0.443
>    .y7                3.431    0.713    4.814    0.000    3.431    0.322
>    .y8                3.254    0.695    4.685    0.000    3.254    0.315
>     ind60             0.448    0.087    5.173    0.000    1.000    1.000
>    .dem60             3.956    0.921    4.295    0.000    0.800    0.800
>    .dem65             0.172    0.215    0.803    0.422    0.039    0.039
> ```

> [!note] 还可以按照分组变量将数据分组进行分析： `fit.group <- sem(model, data=datafile,group="group")`

#### 2.2. 判断模型拟合程度

随后通过指令，输出模型的适配指数，进而来衡量模型的拟合程度

- 输出指定适配指数：`fitMeasures(fit, c("chisq","df","cfi","nnfi","rmsea","srmr"))`
- 输出全部适配指数：`fitmeasures(fit)`

通过指令我们就可以得到相关的指数，从下面的输出信息可以看出，拟合出来的模型匹配度很高 (如果适配度不高，就需要进一步调整模型)。

```R
> fitMeasures(fit,c("chisq","df","CFI","tli","rmsea"))
 chisq     df    cfi    tli  rmsea 
38.125 35.000  0.995  0.993  0.035
```

之后就可以通过 `semPaths` 包来生成结构模型图 [^15]，

```R
semPaths(fit,
        whatLabels = "std", # 线上的标签，此处为标准化的载荷量
        layout = "tree", rotation = 2, # 生成树型图，并且逆时针旋转90°
        edge.label.cex = 1, # 因子载荷量的数字的大小
        residuals = F, # 控制是否显示自身方差，Faluse or true
        color = "lightblue") # 对潜变量或指标配色
```

那么，输出的图片如下，虚线为固定指标为 1 的情况，

<img src="https://i.postimg.cc/59DySVHw/结构方程模型_8.png" width="600"/>

我们也可以通过 `inspect(object = fit,what = "std")` 来只查看 $\lambda,\ \theta, \ \psi$ 值，各值含义见 [[#1.3. 基本步骤]] 部分。

> [!note]- 输出
>
> ```R
> > inspect(object = fit,what = "std") # 查看模型系数，即载荷量
> $lambda
>    ind60 dem60 dem65
> x1 0.920 0.000 0.000
> x2 0.973 0.000 0.000
> x3 0.872 0.000 0.000
> y1 0.000 0.850 0.000
> y2 0.000 0.717 0.000
> y3 0.000 0.722 0.000
> y4 0.000 0.846 0.000
> y5 0.000 0.000 0.808
> y6 0.000 0.000 0.746
> y7 0.000 0.000 0.824
> y8 0.000 0.000 0.828
> 
> $theta
>       x1    x2    x3    y1    y2    y3    y4    y5    y6    y7    y8
> x1 0.154                                                            
> x2 0.000 0.053                                                      
> x3 0.000 0.000 0.239                                                
> y1 0.000 0.000 0.000 0.277                                          
> y2 0.000 0.000 0.000 0.000 0.486                                    
> y3 0.000 0.000 0.000 0.000 0.000 0.478                              
> y4 0.000 0.000 0.000 0.000 0.273 0.000 0.285                        
> y5 0.000 0.000 0.000 0.296 0.000 0.000 0.000 0.347                  
> y6 0.000 0.000 0.000 0.000 0.356 0.000 0.000 0.000 0.443            
> y7 0.000 0.000 0.000 0.000 0.000 0.191 0.000 0.000 0.000 0.322      
> y8 0.000 0.000 0.000 0.000 0.000 0.000 0.109 0.000 0.338 0.000 0.315
> 
> $psi
>       ind60 dem60 dem65
> ind60 1.000            
> dem60 0.000 0.800      
> dem65 0.000 0.000 0.039
> 
> $beta
>       ind60 dem60 dem65
> ind60 0.000 0.000     0
> dem60 0.447 0.000     0
> dem65 0.182 0.885     0
> ```

#### 2.3. 模型修正

之后，我们可以通过 `modindices(fit, sort = TRUE)` 输出修正指标，根据修正指标重新调整代码。

> [!note]- 输出
>
> ```R
> > modindices(fit.group, sort = TRUE)
>              lhs op     rhs block group level     mi    epc sepc.lv
> 108          IQp ~~  EmoReg     1     1     1 38.858  9.649   9.649
> 172          IQp ~~  EmoReg     2     2     1 25.631  8.237   8.237
> 102          IQv ~~  EmoReg     1     1     1 22.172 -6.923  -6.923
> 120         Comm ~~ science     1     1     1 14.237  6.598   6.598
> 147    socialemo =~     IQv     2     2     1 11.402 -0.636  -3.052
> 148    socialemo =~     IQp     2     2     1 11.402  0.524   2.517
> 155       school =~  EmoReg     2     2     1 11.057 -0.373  -2.988
> 156       school =~    Comm     2     2     1 11.057  0.349   2.796
> 112          IQp ~~  salary     1     1     1 10.241  5.312   5.312
> 92        school =~    Comm     1     1     1 10.151  0.254   2.210
> 91        school =~  EmoReg     1     1     1 10.150 -0.264  -2.296
> 109          IQp ~~    Comm     1     1     1  9.783 -4.645  -4.645
> 113          IQp ~~  peerev     1     1     1  8.883 -4.765  -4.765
> 90        school =~     IQp     1     1     1  8.517 -0.325  -2.824
> 89        school =~     IQv     1     1     1  8.517  0.338   2.937
> 126      science ~~  salary     1     1     1  8.348 -5.184  -5.184
> 162          job =~    Comm     2     2     1  7.993 -0.524  -2.043
> 161          job =~  EmoReg     2     2     1  7.993  0.560   2.183
> 141 intelligence =~  EmoReg     2     2     1  7.941  0.135   1.285
> 142 intelligence =~    Comm     2     2     1  7.941 -0.126  -1.203
> 86     socialemo =~ science     1     1     1  7.914  1.420   6.159
> 85     socialemo =~    arts     1     1     1  7.914 -1.348  -5.847
> 98           job =~    Comm     1     1     1  7.872 -0.487  -2.207
> 97           job =~  EmoReg     1     1     1  7.871  0.506   2.293
> 111          IQp ~~ science     1     1     1  7.787 -8.979  -8.979
> 175          IQp ~~ science     2     2     1  7.500 -9.192  -9.192
> 166          IQv ~~  EmoReg     2     2     1  7.365 -4.490  -4.490
> 169          IQv ~~ science     2     2     1  7.168  9.048   9.048
> 171          IQv ~~  peerev     2     2     1  6.700  4.700   4.700
> 83     socialemo =~     IQv     1     1     1  6.514 -0.675  -2.929
> 84     socialemo =~     IQp     1     1     1  6.514  0.650   2.817
> 164          job =~ science     2     2     1  6.300 -1.092  -4.258
> 163          job =~    arts     2     2     1  6.300  1.042   4.063
> 190      science ~~  salary     2     2     1  6.074 -4.239  -4.239
> 184         Comm ~~ science     2     2     1  5.945  4.352   4.352
> 99           job =~    arts     1     1     1  5.437  0.701   3.179
> 100          job =~ science     1     1     1  5.437 -0.739  -3.348
> 173          IQp ~~    Comm     2     2     1  5.192 -3.839  -3.839
> 106          IQv ~~  salary     1     1     1  5.179 -3.634  -3.634
> 149    socialemo =~    arts     2     2     1  4.972 -0.507  -2.436
> 150    socialemo =~ science     2     2     1  4.972  0.532   2.553
> 188         arts ~~  salary     2     2     1  4.775  3.529   3.529
> 177          IQp ~~  peerev     2     2     1  4.573 -3.657  -3.657
> 107          IQv ~~  peerev     1     1     1  4.386  3.232   3.232
> 170          IQv ~~  salary     2     2     1  3.854 -3.587  -3.587
> 124         arts ~~  salary     1     1     1  3.760  3.346   3.346
> 79  intelligence =~    arts     1     1     1  3.702  0.220   1.964
> 80  intelligence =~ science     1     1     1  3.702 -0.232  -2.068
> 103          IQv ~~    Comm     1     1     1  3.518  2.647   2.647
> 77  intelligence =~  EmoReg     1     1     1  3.259  0.101   0.898
> 78  intelligence =~    Comm     1     1     1  3.259 -0.097  -0.864
> 179       EmoReg ~~    arts     2     2     1  3.127 -2.948  -2.948
> 105          IQv ~~ science     1     1     1  2.974  5.280   5.280
> 181       EmoReg ~~  salary     2     2     1  2.841  1.399   1.399
> 151    socialemo =~  salary     2     2     1  2.347  0.139   0.668
> 152    socialemo =~  peerev     2     2     1  2.347 -0.140  -0.674
> 176          IQp ~~  salary     2     2     1  2.012  2.452   2.452
> 116       EmoReg ~~ science     1     1     1  1.951 -2.544  -2.544
> 95           job =~     IQv     1     1     1  1.950 -0.677  -3.071
> 96           job =~     IQp     1     1     1  1.950  0.652   2.953
> 104          IQv ~~    arts     1     1     1  1.737  3.876   3.876
> 119         Comm ~~    arts     1     1     1  1.622 -2.137  -2.137
> 127      science ~~  peerev     1     1     1  1.588  2.172   2.172
> 93        school =~  salary     1     1     1  1.538 -0.080  -0.692
> 94        school =~  peerev     1     1     1  1.538  0.078   0.681
> 122         Comm ~~  peerev     1     1     1  1.481 -1.008  -1.008
> 154       school =~     IQp     2     2     1  1.383 -0.136  -1.087
> 153       school =~     IQv     2     2     1  1.383  0.164   1.318
> 115       EmoReg ~~    arts     1     1     1  1.287 -1.983  -1.983
> 118       EmoReg ~~  peerev     1     1     1  1.170  0.933   0.933
> 145 intelligence =~  salary     2     2     1  1.123 -0.074  -0.707
> 146 intelligence =~  peerev     2     2     1  1.123  0.075   0.713
> 160          job =~     IQp     2     2     1  1.009 -1.152  -4.489
> 159          job =~     IQv     2     2     1  1.009  1.396   5.443
> 82  intelligence =~  peerev     1     1     1  0.740 -0.063  -0.565
> 81  intelligence =~  salary     1     1     1  0.740  0.064   0.573
> 168          IQv ~~    arts     2     2     1  0.706 -2.672  -2.672
> 180       EmoReg ~~ science     2     2     1  0.543 -1.306  -1.306
> 185         Comm ~~  salary     2     2     1  0.486 -0.587  -0.587
> 182       EmoReg ~~  peerev     2     2     1  0.291 -0.441  -0.441
> 174          IQp ~~    arts     2     2     1  0.281  1.663   1.663
> 110          IQp ~~    arts     1     1     1  0.275 -1.625  -1.625
> 186         Comm ~~  peerev     2     2     1  0.268 -0.428  -0.428
> 87     socialemo =~  salary     1     1     1  0.150 -0.069  -0.298
> 88     socialemo =~  peerev     1     1     1  0.150  0.068   0.294
> 191      science ~~  peerev     2     2     1  0.146  0.647   0.647
> 117       EmoReg ~~  salary     1     1     1  0.119  0.309   0.309
> 125         arts ~~  peerev     1     1     1  0.098 -0.519  -0.519
> 183         Comm ~~    arts     2     2     1  0.079  0.472   0.472
> 144 intelligence =~ science     2     2     1  0.059 -0.024  -0.227
> ```

> [!example]- 最终的 R 脚本 (将先前所有代码集合，除了使用 semPaths 包画图)
>
> ```R
> library(haven) # 用于导入sav数据文件
> library(lavaan)
> #check the features from the package
> help(haven)
> help(lavaan)
> # read data set
> datafile <-read_sav("例题1201-智力社情学业职业-SEM.sav")
> 
> model <- '
>   # measurement model
>     intelligence =~ IQv+ IQp
>     socialemo =~ EmoReg+Comm
>     school =~ arts+science
>     job =~salary+peerev
>   # regressions
>     school ~ intelligence+socialemo
>     job ~ intelligence+socialemo+school
>   # residual correlations
>   #correlations between Xs
>    intelligence ~~ socialemo
> '
>    
> fit <- sem(model, data=datafile)
> summary(fit, standardized=TRUE)
> fitMeasures(fit, c("chisq","df","cfi","nnfi","rmsea","srmr"))
> modindices(fit, sort = TRUE)
> 
> fit.group <- sem(model, data=datafile,group="group")
> summary(fit.group, standardized=TRUE)
> fitMeasures(fit.group, c("chisq","df","cfi","nnfi","rmsea","srmr"))
> modindices(fit.group, sort = TRUE)
> 
> ```

### 4. 使用 Mplus 进行 SEM

Mplus 虽然主要用来做 SEM，但是也可以做多变量回归分析 (multiple regression)、因素分析 (factor analysis)、项目反应理论模型 (item response theory)、混合模型 (mixture models)、等级线性模型 (multi-level models)[^16] [^17]。

其导出的常见文件类型如下：输入文档 `inp`、输出文档 `out`。虽然 Mplus 支持读取 csv、dat、txt 等多种文件格式 (默认读取在同一个目录下的数据文档)，但是有个很重要也很麻烦的要求，即**数据文档不能包含变量名称**，最大支持 500 个变量 [^16]。

> [!note] Mplus 基础语法 [^16]
> 一些代码书写规则：
> 1. 分号 ($;$) 标志语句的结束；
> 2. 不区分大小写 (NOT CASE SENsiTivE/not case sensitive/NoT cAsE sEnsiTiVe)；
> 3. Be 动词可以互换 (file = example.dat/ file is example.dat/ file are example.dat)；
> 4. 每一行不能超过 90 个字符；
> 5. “!”标志注释开始，注释部分文字为绿色，Mplus 不会运行注释部分的语句。

Mplus 的脚本文件主要包含 `TITLE` `DATA` `VARIABLE` `MODEL` `OUTPUT` 几个 (必要) 部分。编辑好脚本后，点击“RUN”运行。

1. TITLE：制定脚本名称；
2. DATA：导入数据文件；
3. VARIABLE：设置变量，按数据文件中的列排序；
4. MODEL：模型设定，主要使用 `BY` `WITH` `ON` 来预设变量之间的关系。
	- 测量模型：潜变量 BY 观察变量 1 观察变量 2；
	- 结构模型：因变量 ON 自变量 1 自变量 2；
	- 潜变量的协方差 (相关)：潜变量 WITH 潜变量。
5. OUTPUT：在基础导出内容以外，再制定导出一些内容，比如使用 `STDYX` 导出标准化的估计参数。

```Mplus
TITLE: SEM
DATA:
    FILE=SEM file.csv;  !设定数据文件，默认读取同一个目录下的文件；
VARIABLE:
    NAMES ARE   !设定你的变量名称，按数据文件中的列排序；
    ID group arts science salary peerev IQv IQp EmoReg Comm;
    USEVARIABLES ARE    !告诉 Mplus 你在模型中使用哪些变量； 可以简写为USEVAR
    arts science salary peerev IQv IQp EmoReg Comm;
    !MISSING = X1(9) X2(9);     !设定缺失数据数值；数值9表示变量x1和x2的缺失值；
    !MISSING ARE ALL(-999);     !设定-999为所有变量的缺失值。
    !DEFINE： XSUM = X1 + X2 + X3+ X4 + X5;     !定义新变量，例如分析调节效应时设定交互项AB=A*B;


!ANALYSIS: !设定分析方法或如何估计自由参数；

MODEL:
    intelligence BY IQv IQp;        !BY表示因素，潜变量BY观察变量1 观察变量2 观察变量3...
    socilemo BY EmoReg Comm;
    school BY arts science;
    job BY salary peerev;
    school ON intelligence socilemo;        !ON表示回归关系，因变量ON自变量1 自变量2 自变量3...
    job ON intelligence socilemo school;
    intelligence WITH socilemo;     !WITH表示协方差（covariance）
OUTPUT:     !设定输出选项
    SAMPSTAT STDYX MODINDICES(4); !STDYX 标准化之后的数据   MODINDICES 为模型修正参数
!SAVEDATA:   !创建新的数据文档   
PLOT:   !创建图表文件
!MONTECARLO: !进行蒙特卡洛方法分析（统计模拟方法）
```

> [!note]- 输出
>
> ```Mplus
> Mplus VERSION 8.3
> MUTHEN & MUTHEN
> 11/13/2025  11:33 AM
> 
> INPUT INSTRUCTIONS
> 
>   TITLE: SEM
>   DATA:
>   FILE=SEM file.csv;
>   VARIABLE:
>   NAMES ARE
>   ID group arts science salary peerev IQv IQp EmoReg Comm;
>   USEVARIABLES ARE
>   arts science salary peerev IQv IQp EmoReg Comm;
> 
> 
>   MODEL:
>   intelligence BY IQv IQp;
>   socilemo BY EmoReg Comm;
>   school BY arts science;
>   job BY salary peerev;
>   school ON intelligence socilemo;
>   job ON intelligence socilemo school;
>   intelligence WITH socilemo;
>   OUTPUT:
>   SAMPSTAT STDYX MODINDICES(4);
> 
> 
> 
> INPUT READING TERMINATED NORMALLY
> 
> 
> 
> SEM
> 
> SUMMARY OF ANALYSIS
> 
> Number of groups                                                 1
> Number of observations                                         500
> 
> Number of dependent variables                                    8
> Number of independent variables                                  0
> Number of continuous latent variables                            4
> 
> Observed dependent variables
> 
>   Continuous
>    ARTS        SCIENCE     SALARY      PEEREV      IQV         IQP
>    EMOREG      COMM
> 
> Continuous latent variables
>    INTELLIG    SOCILEMO    SCHOOL      JOB
> 
> 
> Estimator                                                       ML
> Information matrix                                        OBSERVED
> Maximum number of iterations                                  1000
> Convergence criterion                                    0.500D-04
> Maximum number of steepest descent iterations                   20
> 
> Input data file(s)
>   SEM file.csv
> 
> Input data format  FREE
> 
> 
> SAMPLE STATISTICS
> 
> 
>      SAMPLE STATISTICS
> 
> 
>            Means
>               ARTS          SCIENCE       SALARY        PEEREV        IQV
>               ________      ________      ________      ________      ________
>                99.534        99.450        29.976        29.818        99.394
> 
> 
>            Means
>               IQP           EMOREG        COMM
>               ________      ________      ________
>               100.184        30.026        29.760
> 
> 
>            Covariances
>               ARTS          SCIENCE       SALARY        PEEREV        IQV
>               ________      ________      ________      ________      ________
>  ARTS         101.521
>  SCIENCE       73.764       112.847
>  SALARY        24.973        20.973        26.939
>  PEEREV        23.955        24.082        17.774        25.681
>  IQV           46.490        47.805        26.503        28.264       104.823
>  IQP           37.930        33.073        26.524        22.919        75.820
>  EMOREG        22.362        25.836        13.511        12.857        21.388
>  COMM          23.808        29.446        11.438        10.842        19.167
> 
> 
>            Covariances
>               IQP           EMOREG        COMM
>               ________      ________      ________
>  IQP          105.310
>  EMOREG        27.891        28.381
>  COMM          17.940        19.858        27.614
> 
> 
>            Correlations
>               ARTS          SCIENCE       SALARY        PEEREV        IQV
>               ________      ________      ________      ________      ________
>  ARTS           1.000
>  SCIENCE        0.689         1.000
>  SALARY         0.478         0.380         1.000
>  PEEREV         0.469         0.447         0.676         1.000
>  IQV            0.451         0.440         0.499         0.545         1.000
>  IQP            0.367         0.303         0.498         0.441         0.722
>  EMOREG         0.417         0.457         0.489         0.476         0.392
>  COMM           0.450         0.527         0.419         0.407         0.356
> 
> 
>            Correlations
>               IQP           EMOREG        COMM
>               ________      ________      ________
>  IQP            1.000
>  EMOREG         0.510         1.000
>  COMM           0.333         0.709         1.000
> 
> 
> UNIVARIATE SAMPLE STATISTICS
> 
> 
>      UNIVARIATE HIGHER-ORDER MOMENT DESCRIPTIVE STATISTICS
> 
>          Variable/         Mean/     Skewness/   Minimum/ % with                Percentiles
>         Sample Size      Variance    Kurtosis    Maximum  Min/Max      20%/60%    40%/80%    Median
> 
>      ARTS                 99.534      -0.065      66.000    0.20%      90.000     97.000     99.000
>              500.000     101.521      -0.061     135.000    0.20%     102.000    108.000
>      SCIENCE              99.450       0.113      67.000    0.20%      90.000     96.000     99.000
>              500.000     112.847      -0.194     135.000    0.20%     102.000    109.000
>      SALARY               29.976       0.055      15.000    0.40%      26.000     29.000     30.000
>              500.000      26.939       0.006      46.000    0.20%      31.000     34.000
>      PEEREV               29.818       0.181      16.000    0.40%      25.000     29.000     30.000
>              500.000      25.681      -0.011      46.000    0.20%      31.000     34.000
>      IQV                  99.394       0.192      68.000    0.20%      91.000     96.000     99.000
>              500.000     104.823       0.138     135.000    0.20%     102.000    108.000
>      IQP                 100.184      -0.013      68.000    0.20%      91.000     98.000    100.000
>              500.000     105.310      -0.038     130.000    0.20%     103.000    109.000
>      EMOREG               30.026      -0.123      12.000    0.20%      26.000     29.000     30.000
>              500.000      28.381       0.212      47.000    0.20%      31.000     34.000
>      COMM                 29.760       0.017      13.000    0.20%      25.000     28.000     30.000
>              500.000      27.614      -0.056      46.000    0.40%      31.000     34.000
> 
> 
> THE MODEL ESTIMATION TERMINATED NORMALLY
> 
> 
> 
> MODEL FIT INFORMATION
> 
> Number of Free Parameters                       30
> 
> Loglikelihood
> 
>           H0 Value                      -12642.583
>           H1 Value                      -12576.430
> 
> Information Criteria
> 
>           Akaike (AIC)                   25345.166
>           Bayesian (BIC)                 25471.604
>           Sample-Size Adjusted BIC       25376.382
>             (n* = (n + 2) / 24)
> 
> Chi-Square Test of Model Fit
> 
>           Value                            132.305
>           Degrees of Freedom                    14
>           P-Value                           0.0000
> 
> RMSEA (Root Mean Square Error Of Approximation)
> 
>           Estimate                           0.130
>           90 Percent C.I.                    0.110  0.151
>           Probability RMSEA <= .05           0.000
> 
> CFI/TLI
> 
>           CFI                                0.944
>           TLI                                0.887
> 
> Chi-Square Test of Model Fit for the Baseline Model
> 
>           Value                           2128.092
>           Degrees of Freedom                    28
>           P-Value                           0.0000
> 
> SRMR (Standardized Root Mean Square Residual)
> 
>           Value                              0.033
> 
> 
> 
> MODEL RESULTS
> 
>                                                     Two-Tailed
>                     Estimate       S.E.  Est./S.E.    P-Value
> 
>  INTELLIG BY
>     IQV                1.000      0.000    999.000    999.000
>     IQP                0.901      0.057     15.882      0.000
> 
>  SOCILEMO BY
>     EMOREG             1.000      0.000    999.000    999.000
>     COMM               0.946      0.059     15.985      0.000
> 
>  SCHOOL   BY
>     ARTS               1.000      0.000    999.000    999.000
>     SCIENCE            1.050      0.066     15.852      0.000
> 
>  JOB      BY
>     SALARY             1.000      0.000    999.000    999.000
>     PEEREV             0.995      0.058     17.155      0.000
> 
>  SCHOOL   ON
>     INTELLIGEN         0.277      0.053      5.241      0.000
>     SOCILEMO           0.899      0.115      7.791      0.000
> 
>  JOB      ON
>     INTELLIGEN         0.200      0.027      7.319      0.000
>     SOCILEMO           0.244      0.060      4.060      0.000
>     SCHOOL             0.117      0.033      3.515      0.000
> 
>  INTELLIG WITH
>     SOCILEMO          22.711      2.612      8.697      0.000
> 
>  Intercepts
>     ARTS              99.534      0.451    220.891      0.000
>     SCIENCE           99.450      0.475    209.336      0.000
>     SALARY            29.976      0.232    129.141      0.000
>     PEEREV            29.818      0.227    131.571      0.000
>     IQV               99.394      0.458    217.079      0.000
>     IQP              100.184      0.459    218.297      0.000
>     EMOREG            30.026      0.238    126.028      0.000
>     COMM              29.760      0.235    126.634      0.000
> 
>  Variances
>     INTELLIGEN        84.141      7.813     10.769      0.000
>     SOCILEMO          20.983      2.037     10.303      0.000
> 
>  Residual Variances
>     ARTS              31.294      4.081      7.669      0.000
>     SCIENCE           35.369      4.528      7.811      0.000
>     SALARY             9.081      0.973      9.329      0.000
>     PEEREV             7.992      0.928      8.610      0.000
>     IQV               20.682      4.529      4.566      0.000
>     IQP               36.989      4.227      8.750      0.000
>     EMOREG             7.398      1.168      6.335      0.000
>     COMM               8.821      1.109      7.954      0.000
>     SCHOOL            35.556      4.597      7.734      0.000
>     JOB                6.604      0.888      7.434      0.000
> 
> 
> STANDARDIZED MODEL RESULTS
> 
> STDYX Standardization
> 
>                                                     Two-Tailed
>                     Estimate       S.E.  Est./S.E.    P-Value
> 
>  INTELLIG BY
>     IQV                0.896      0.025     36.249      0.000
>     IQP                0.805      0.026     30.943      0.000
> 
>  SOCILEMO BY
>     EMOREG             0.860      0.025     34.627      0.000
>     COMM               0.825      0.025     32.444      0.000
> 
>  SCHOOL   BY
>     ARTS               0.832      0.025     32.964      0.000
>     SCIENCE            0.829      0.025     32.762      0.000
> 
>  JOB      BY
>     SALARY             0.814      0.023     34.772      0.000
>     PEEREV             0.830      0.023     36.145      0.000
> 
>  SCHOOL   ON
>     INTELLIGEN         0.303      0.055      5.495      0.000
>     SOCILEMO           0.491      0.055      8.968      0.000
> 
>  JOB      ON
>     INTELLIGEN         0.434      0.052      8.288      0.000
>     SOCILEMO           0.264      0.063      4.181      0.000
>     SCHOOL             0.231      0.066      3.531      0.000
> 
>  INTELLIG WITH
>     SOCILEMO           0.541      0.044     12.298      0.000
> 
>  Intercepts
>     ARTS               9.879      0.316     31.304      0.000
>     SCIENCE            9.362      0.299     31.268      0.000
>     SALARY             5.775      0.188     30.715      0.000
>     PEEREV             5.884      0.191     30.747      0.000
>     IQV                9.708      0.310     31.293      0.000
>     IQP                9.763      0.312     31.296      0.000
>     EMOREG             5.636      0.184     30.672      0.000
>     COMM               5.663      0.185     30.681      0.000
> 
>  Variances
>     INTELLIGEN         1.000      0.000    999.000    999.000
>     SOCILEMO           1.000      0.000    999.000    999.000
> 
>  Residual Variances
>     ARTS               0.308      0.042      7.344      0.000
>     SCIENCE            0.313      0.042      7.478      0.000
>     SALARY             0.337      0.038      8.841      0.000
>     PEEREV             0.311      0.038      8.165      0.000
>     IQV                0.197      0.044      4.455      0.000
>     IQP                0.351      0.042      8.376      0.000
>     EMOREG             0.261      0.043      6.105      0.000
>     COMM               0.319      0.042      7.614      0.000
>     SCHOOL             0.506      0.047     10.845      0.000
>     JOB                0.370      0.041      9.119      0.000
> 
> 
> R-SQUARE
> 
>     Observed                                        Two-Tailed
>     Variable        Estimate       S.E.  Est./S.E.    P-Value
> 
>     ARTS               0.692      0.042     16.482      0.000
>     SCIENCE            0.687      0.042     16.381      0.000
>     SALARY             0.663      0.038     17.386      0.000
>     PEEREV             0.689      0.038     18.072      0.000
>     IQV                0.803      0.044     18.125      0.000
>     IQP                0.649      0.042     15.472      0.000
>     EMOREG             0.739      0.043     17.314      0.000
>     COMM               0.681      0.042     16.222      0.000
> 
>      Latent                                         Two-Tailed
>     Variable        Estimate       S.E.  Est./S.E.    P-Value
> 
>     SCHOOL             0.494      0.047     10.575      0.000
>     JOB                0.630      0.041     15.542      0.000
> 
> 
> QUALITY OF NUMERICAL RESULTS
> 
>      Condition Number for the Information Matrix              0.922E-04
>        (ratio of smallest to largest eigenvalue)
> 
> 
> MODEL MODIFICATION INDICES
> 
> NOTE:  Modification indices for direct effects of observed dependent variables
> regressed on covariates may not be included.  To include these, request
> MODINDICES (ALL).
> 
> Minimum M.I. value for printing the modification index     4.000
> 
>                                    M.I.     E.P.C.  Std E.P.C.  StdYX E.P.C.
> 
> BY Statements
> 
> INTELLIG BY EMOREG                10.978     0.123      1.130        0.212
> INTELLIG BY COMM                  10.981    -0.117     -1.070       -0.204
> SOCILEMO BY ARTS                  12.153    -0.760     -3.482       -0.346
> SOCILEMO BY SCIENCE               12.155     0.798      3.658        0.344
> SOCILEMO BY IQV                   18.878    -0.651     -2.983       -0.291
> SOCILEMO BY IQP                   18.876     0.587      2.688        0.262
> SCHOOL   BY IQV                    7.903     0.252      2.111        0.206
> SCHOOL   BY IQP                    7.902    -0.227     -1.902       -0.185
> SCHOOL   BY EMOREG                20.153    -0.301     -2.524       -0.474
> SCHOOL   BY COMM                  20.152     0.285      2.389        0.455
> JOB      BY ARTS                  12.188     0.870      3.678        0.365
> JOB      BY SCIENCE               12.183    -0.914     -3.862       -0.364
> JOB      BY EMOREG                14.823     0.514      2.172        0.408
> JOB      BY COMM                  14.827    -0.486     -2.055       -0.391
> 
> WITH Statements
> 
> SALARY   WITH ARTS                 8.173     3.385      3.385        0.201
> SALARY   WITH SCIENCE             14.403    -4.739     -4.739       -0.264
> IQV      WITH SCIENCE              9.425     7.052      7.052        0.261
> IQV      WITH SALARY               8.270    -3.491     -3.491       -0.255
> IQV      WITH PEEREV              10.932     3.930      3.930        0.306
> IQP      WITH SCIENCE             14.864    -9.028     -9.028       -0.250
> IQP      WITH SALARY               9.894     3.799      3.799        0.207
> IQP      WITH PEEREV              13.020    -4.251     -4.251       -0.247
> EMOREG   WITH ARTS                 4.211    -2.484     -2.484       -0.163
> EMOREG   WITH IQV                 27.467    -5.825     -5.825       -0.471
> EMOREG   WITH IQP                 63.546     9.013      9.013        0.545
> COMM     WITH SCIENCE             18.417     5.398      5.398        0.306
> COMM     WITH IQP                 14.310    -4.277     -4.277       -0.237
> 
> 
> DIAGRAM INFORMATION
> 
>   Use View Diagram under the Diagram menu in the Mplus Editor to view the diagram.
>   If running Mplus from the Mplus Diagrammer, the diagram opens automatically.
> 
>   Diagram output
>     C:\Users\Shi\Desktop\SEM\j教学\Mplus\SEM-no group.dgm
> 
>      Beginning Time:  11:33:50
>         Ending Time:  11:33:50
>        Elapsed Time:  00:00:00
> 
> 
> 
> MUTHEN & MUTHEN
> 3463 Stoner Ave.
> Los Angeles, CA  90066
> 
> Tel: (310) 391-9971
> Fax: (310) 391-8971
> Web: www.StatModel.com
> Support: Support@StatModel.com
> 
> Copyright (c) 1998-2019 Muthen & Muthen
> 
> ```

在 Mplus 中的 `File - Open - 将检索的文件类型改为 Output Files (*.out) - 选择 out 文件` 查看输出结果。输出结果也比较可观，主要关注 `MODEL FIT INFORMATION` `MODEL RESULTS` `STANDARDIZED MODEL RESULTS` `MODEL MODIFICATION INDICES` 这几个表。同 R 一样，根据模型修正指数修改代码。

因为我们的 Mplus 脚本中写了“PLOT”，所以也给我们生成了 dgm 文件。我们需要依次点击 `Diagram - View Diagram`，这样就可以自动打开刚刚生成的结构模型图。里面的各个元素均可拖动，并且可以通过勾选 `View` 中调整勾选，以选择是否呈现残差、是否呈现标准化系数等。

[^1]: [因果推断三大流派POM/SEM/SCM深度解析](https://mp.weixin.qq.com/s/lgZeBwYijGedzntrgYJmvw)
[^2]: [《与结构方程模型共舞》(张伟豪)第1-3章讲解_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1XH4y1A7k7)
[^3]: [社会科学统计模型第二期：结构方程模型(SEM)入门_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1Tz4y1C7RR)
[^4]: [文献解读：结构方程模型SEM基础，小白看这个就基本够了 - 知乎](https://zhuanlan.zhihu.com/p/359327501)
[^5]: 多重共线性是指在回归分析中，解释变量之间存在强烈的线性相关性，即两个或多个自变量高度相关，以至于难以区分它们对因变量的独立影响。这可能会导致原本应显著的变量变得不显著，或原本不显著的变量变得显著。
[^6]: [结构方程如何计算参数量和自由度DF | DataSense](https://mlln.cn/2025/08/22/004%20%E7%BB%93%E6%9E%84%E6%96%B9%E7%A8%8B%E6%A8%A1%E5%9E%8B/%E7%BB%93%E6%9E%84%E6%96%B9%E7%A8%8B%E5%A6%82%E4%BD%95%E8%AE%A1%E7%AE%97%E5%8F%82%E6%95%B0%E9%87%8F%E5%92%8C%E8%87%AA%E7%94%B1%E5%BA%A6DF/)
[^7]: 路径分析 (path analysis) 是 SEM 方法的其中一种，研究的是结构模型，而无测量模型，而且模型中均为观察变量，无潜变量。但是在大部分研究中，研究者通常会采用验证性因子分析 (confirmatory factor analysis) 来从观察变量中提取潜变量，从而将潜变量带入到模型中。如果一个模型中结合了路径分析和验证性因素分析，即既包含了结构模型，又包含了测量模型，那么可以称之为完全结构方程模型 (Full SEM)。
[^8]: ⭐[结构方程模型(SEM)及其R实现_结构方程模型 r-CSDN博客](https://blog.csdn.net/qq_42458954/article/details/106760985)
[^9]: 见课程 pdf `研一上/心理统计方法与应用/8_结构方程模型.pdf`
[^10]: ⭐[《与结构方程模型共舞》(张伟豪)第4-8章讲解(上)_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1SH4y1g7kt)
[^11]: [【Amos结构方程教程】Amos分类调节变量多群组分析的操作与详解 ——【杏花开生物医药统计】 - 知乎](https://zhuanlan.zhihu.com/p/82726608)
[^12]: [amos21.0教程：[26]标准化路径系数不显示-百度经验](https://jingyan.baidu.com/article/c33e3f48a52453ea15cbb5d7.html)
[^13]: [lavaan.org - About lavaan](https://www.lavaan.ugent.be/)
[^14]: ⭐[R语言保姆级教程/结构方程模型SEM/全B站最牛逼，没有之一_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1R84y1i7yf)
[^15]: ⭐[用semPlot在R中绘制SEM图 - 知乎](https://zhuanlan.zhihu.com/p/50237434)
[^16]: [社会科学统计模型第三期：Mplus基础操作_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1nv411b7Nv/)
[^17]: [Mplus User's Guide Excerpts](https://www.statmodel.com/ugexcerpts.shtml)